@* Responsive navigation menu that adapts to platform and screen size *@
@using PhysicallyFitPT.Shared

@inject IPlatformInfo PlatformInfo

<nav class="pfp-nav" data-platform="@PlatformInfo.Platform.ToString().ToLower()" data-device="@PlatformInfo.Device.ToString().ToLower()">
  @if (ShouldShowSideNav())
  {
    <div class="pfp-nav-sidebar">
      @RenderNavItems()
    </div>
  }
  else
  {
    <div class="pfp-nav-mobile">
      <button class="pfp-nav-toggle" @onclick="ToggleMobileNav" aria-label="Toggle navigation">
        <span class="pfp-hamburger"></span>
      </button>
      
      @if (showMobileNav)
      {
        <div class="pfp-nav-overlay" @onclick="CloseMobileNav"></div>
        <div class="pfp-nav-drawer">
          @RenderNavItems()
        </div>
      }
    </div>
  }
</nav>

@code {
  private bool showMobileNav = false;

  private bool ShouldShowSideNav()
  {
    // Show sidebar for desktop browsers and desktop MAUI apps
    return PlatformInfo.Device == DeviceType.Desktop || 
           (PlatformInfo.Platform == PlatformType.Web && (PlatformInfo.ScreenWidth ?? 0) >= 1024);
  }

  private void ToggleMobileNav()
  {
    showMobileNav = !showMobileNav;
  }

  private void CloseMobileNav()
  {
    showMobileNav = false;
  }

  private RenderFragment RenderNavItems() => __builder =>
  {
    <ul class="pfp-nav-list">
      <li class="pfp-nav-item">
        <NavLink href="/" class="pfp-nav-link" Match="NavLinkMatch.All" @onclick="CloseMobileNav">
          <span class="pfp-nav-icon">ğŸ </span>
          Dashboard
        </NavLink>
      </li>
      <li class="pfp-nav-item">
        <NavLink href="/login" class="pfp-nav-link" @onclick="CloseMobileNav">
          <span class="pfp-nav-icon">ğŸ”</span>
          Login
        </NavLink>
      </li>
      <li class="pfp-nav-item">
        <NavLink href="/patients" class="pfp-nav-link" @onclick="CloseMobileNav">
          <span class="pfp-nav-icon">ğŸ‘¥</span>
          Patients
        </NavLink>
      </li>
      <li class="pfp-nav-item">
        <NavLink href="/intake" class="pfp-nav-link" @onclick="CloseMobileNav">
          <span class="pfp-nav-icon">ğŸ“‹</span>
          Patient Intake
        </NavLink>
      </li>
      <li class="pfp-nav-item">
        <NavLink href="/appointments" class="pfp-nav-link" @onclick="CloseMobileNav">
          <span class="pfp-nav-icon">ğŸ“…</span>
          Appointments
        </NavLink>
      </li>
      <li class="pfp-nav-item">
        <NavLink href="/notes/eval" class="pfp-nav-link" @onclick="CloseMobileNav">
          <span class="pfp-nav-icon">ğŸ“</span>
          Eval Note
        </NavLink>
      </li>
      <li class="pfp-nav-item">
        <NavLink href="/notes/daily" class="pfp-nav-link" @onclick="CloseMobileNav">
          <span class="pfp-nav-icon">ğŸ“„</span>
          Daily Note
        </NavLink>
      </li>
      <li class="pfp-nav-item">
        <NavLink href="/notes/progress" class="pfp-nav-link" @onclick="CloseMobileNav">
          <span class="pfp-nav-icon">ğŸ“ˆ</span>
          Progress Note
        </NavLink>
      </li>
      <li class="pfp-nav-item">
        <NavLink href="/notes/discharge" class="pfp-nav-link" @onclick="CloseMobileNav">
          <span class="pfp-nav-icon">ğŸ“‹</span>
          Discharge Note
        </NavLink>
      </li>
      <li class="pfp-nav-item">
        <NavLink href="/ai/summary" class="pfp-nav-link" @onclick="CloseMobileNav">
          <span class="pfp-nav-icon">ğŸ¤–</span>
          AI Summary
        </NavLink>
      </li>
      <li class="pfp-nav-item">
        <NavLink href="/admin/settings" class="pfp-nav-link" @onclick="CloseMobileNav">
          <span class="pfp-nav-icon">âš™ï¸</span>
          Settings
        </NavLink>
      </li>
      <li class="pfp-nav-item">
        <NavLink href="/admin/users" class="pfp-nav-link" @onclick="CloseMobileNav">
          <span class="pfp-nav-icon">ğŸ‘¤</span>
          User Management
        </NavLink>
      </li>
      <li class="pfp-nav-item">
        <NavLink href="/admin/automessaging" class="pfp-nav-link" @onclick="CloseMobileNav">
          <span class="pfp-nav-icon">ğŸ“¨</span>
          Auto Messaging
        </NavLink>
      </li>
      <li class="pfp-nav-item">
        <NavLink href="/ui-kit" class="pfp-nav-link" @onclick="CloseMobileNav">
          <span class="pfp-nav-icon">ğŸ¨</span>
          UI Kit
        </NavLink>
      </li>
    </ul>
  };
}